# Telegram Bot "–ß–µ–ø—É—Ö–∞" (Nonsense)

## Overview
–†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–π –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π Telegram bot –¥–ª—è –∏–≥—Ä—ã –≤ "–ß–µ–ø—É—Ö—É" (party game). 2-6 –∏–≥—Ä–æ–∫–æ–≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–≤–µ—á–∞—é—Ç –Ω–∞ 6 –≤–æ–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤ –¥—Ä—É–≥ –¥—Ä—É–≥–∞. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π –∏–∑ –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤.

## Features
- üéÆ **Room-based system** —Å 4-—Å–∏–º–≤–æ–ª—å–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏ –¥–ª—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚ùì **6 –≤–æ–ø—Ä–æ—Å–æ–≤**: "–ö–∞–∫–æ–π?", "–ö—Ç–æ?", "–° –∫–µ–º?", "–ì–¥–µ?", "–ß—Ç–æ –¥–µ–ª–∞–ª–∏?", "–ß—Ç–æ —Å –Ω–∏–º–∏ —Å—Ç–∞–ª–æ?"
- üéâ **–†–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏** - –∫–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –≤–∏–¥–∏—Ç —Å–≤–æ—é –≤–µ—Ä—Å–∏—é –∏—Å—Ç–æ—Ä–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–æ—Ä—è–¥–∫–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤
- ‚è±Ô∏è **2-–º–∏–Ω—É—Ç–Ω—ã–π —Ç–∞–π–º–∞—É—Ç** - –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç, –∏–≥—Ä–∞ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –∏ –æ–Ω –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è
- üëë **–°–∏—Å—Ç–µ–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤** - —Å–æ–∑–¥–∞—Ç–µ–ª—å –∫–æ–º–Ω–∞—Ç—ã –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É
- üìã **–ö–æ–º–∞–Ω–¥—ã:** `/rules`, `/history`, `/reset`, `/stats`, `/bot_uptime`, `/help`
- üìö **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π** - –≤—Å–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `/history`
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞** - –ø—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä, –∫–æ–º–Ω–∞—Ç, –∏–≥—Ä–æ–∫–æ–≤ —á–µ—Ä–µ–∑ `/stats`
- ü§ñ **–°–∞–º–æ–ø–∏–Ω–≥** - –±–æ—Ç –ø–∏–Ω–≥—É–µ—Ç —Å–µ–±—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

## Tech Stack
- Python 3.11
- python-telegram-bot 20.3
- SQLite3
- asyncio –¥–ª—è —Ç–∞–π–º–∞—É—Ç–æ–≤

## Database Schema
- **games**: –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∏–≥—Ä–µ (room_code, status, created_by)
- **game_players**: –ò–≥—Ä–æ–∫–∏ –≤ –∏–≥—Ä–µ —Å –∏—Ö —Ä–æ–ª—è–º–∏ (user_id, is_admin, awaiting_question_idx)
- **game_answers**: –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã (question_idx, player_idx, answer)
- **game_messages**: ID —Å–æ–æ–±—â–µ–Ω–∏–π Telegram –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## Key Implementation Details

### Async Database Access
- SQLite –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –î–û –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è async Telegram API –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ deadlock'–∏

### Question Timeout Mechanism
- `asyncio.create_task()` –¥–ª—è 2-–º–∏–Ω—É—Ç–Ω—ã—Ö —Ç–∞–π–º–∞—É—Ç–æ–≤ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤–æ–ø—Ä–æ—Å–∞
- –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –æ—Ç–≤–µ—á–∞–µ—Ç - —Ç–∞–π–º–∞—É—Ç –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
- –ï—Å–ª–∏ –∏—Å—Ç–µ–∫–∞–µ—Ç 2 –º–∏–Ω—É—Ç—ã - –∏–≥—Ä–∞ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è, –∏–≥—Ä–æ–∫ –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª—è—é—Ç—Å—è

### Story Rotation Formula
- –ò—Å—Ç–æ—Ä–∏—è N –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∏–≥—Ä–æ–∫–∞: `(N + question_idx) % num_players`
- –ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –≤–∏–¥–∏—Ç 6 —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏

### New Game After Completion
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–≥—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞ —Å —Ç–µ–º –∂–µ room_code
- –í—Å–µ –∏–≥—Ä–æ–∫–∏ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ –Ω–æ–≤—É—é –∫–æ–º–Ω–∞—Ç—É —Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### Multi-player Room Join Fix
- –ö–æ–≥–¥–∞ –Ω–µ–∞–¥–º–∏–Ω –∏–≥—Ä–æ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
- –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º —Ç–µ–∫—É—â–µ–π –∫–æ–º–Ω–∞—Ç—ã ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ç–æ—Ä–æ–º—É –∏–≥—Ä–æ–∫—É —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∏–≥—Ä—ã, –Ω–µ –ø–æ–ª—É—á–∞—è –æ—à–∏–±–æ–∫

## Game Flow
1. Player 1: `/start` ‚Üí "üéÆ –ù–æ–≤–∞—è –∏–≥—Ä–∞" ‚Üí –°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–Ω–∞—Ç–∞ —Å –∫–æ–¥–æ–º
2. Player 1: –î–µ–ª–∏—Ç—Å—è –∫–æ–¥–æ–º
3. Player 2: `/start` ‚Üí "üîë –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ –∫–æ–¥—É" ‚Üí –í–≤–æ–¥–∏—Ç –∫–æ–¥
4. Players: –í–∏–¥—è—Ç —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –∂–¥—É—Ç –Ω–∞—á–∞–ª–∞
5. Player 1 (–∞–¥–º–∏–Ω): –ù–∞–∂–∏–º–∞–µ—Ç "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –∏–≥—Ä—É"
6. –í—Å–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤–æ–ø—Ä–æ—Å—ã –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
7. –ö–∞–∂–¥—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —á–∞—Ç (2 –º–∏–Ω—É—Ç –Ω–∞ –æ—Ç–≤–µ—Ç)
8. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Üí –∫–∞–∂–¥–æ–º—É –ø–æ 6 —Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π
9. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞ ‚Üí –º–æ–∂–Ω–æ –∏–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞

## Setup
1. Set `TELEGRAM_BOT_TOKEN` environment variable with your bot token from BotFather
2. Install: `pip install -r requirements.txt`
3. Run: `python main.py`

## Commands
- `/start` - –ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
- `/rules` - –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
- `/history` - –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π
- `/reset` - –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–ª–æ–º–∞–Ω–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã –∏–≥—Ä–æ–∫–∞
- `/bot_uptime` - –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ –∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞ (–∫–æ–ª-–≤–æ –∏–≥—Ä, –∫–æ–º–Ω–∞—Ç, –∏–≥—Ä–æ–∫–æ–≤, –∏—Å—Ç–æ—Ä–∏–π)
- `/help` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

## User Preferences
- Russian language interface
- Room-based gameplay with 4-char codes
- All commands available through slash commands
- Emergency `/reset` command to delete broken rooms
- Statistics accessible to all users via `/stats`

